server {
  listen ${APP_USER_UI_PORT};
  server_name ans.localhost;
  location /api/validator {
    rewrite ^\/(.*) /$1 break;
    proxy_pass http://splice:2${VALIDATOR_ADMIN_API_PORT_SUFFIX}/api/validator;
  }
  location / {
    proxy_pass http://ans-web-ui-app-user:8080/;
  }
}

# Deprecated, use json-ledger-api.localhost instead
server {
  listen ${APP_USER_UI_PORT};
  server_name canton.localhost;
  location / {
    proxy_pass http://canton:2${PARTICIPANT_JSON_API_PORT_SUFFIX};
    include /etc/nginx/includes/cors-headers.conf;
  }
}

server {
  listen ${APP_USER_UI_PORT};
  server_name json-ledger-api.localhost;
  location / {
    proxy_pass http://canton:2${PARTICIPANT_JSON_API_PORT_SUFFIX};
    include /etc/nginx/includes/cors-headers.conf;
  }
}

server {
  listen ${APP_USER_UI_PORT} http2;
  server_name grpc-ledger-api.localhost;
  location / {
    grpc_pass grpc://canton:2${PARTICIPANT_LEDGER_API_PORT_SUFFIX};
  }
}

server {
  listen ${APP_USER_UI_PORT};
  server_name localhost wallet.localhost;

  # Reverse proxy for /api/validator
  location /api/validator {
    rewrite ^\/(.*) /$1 break;
    proxy_pass http://splice:2${VALIDATOR_ADMIN_API_PORT_SUFFIX}/api/validator;
  }

  # Reverse proxy to wallet-web-ui
  location / {
    proxy_pass http://wallet-web-ui-app-user:8080/;
  }
}
